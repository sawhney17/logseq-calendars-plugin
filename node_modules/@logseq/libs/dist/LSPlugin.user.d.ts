import { LSPluginCaller } from './LSPlugin.caller';
import { IAppProxy, IDBProxy, IEditorProxy, ILSPluginUser, LSPluginBaseInfo, LSPluginUserEvents, StyleString, ThemeOptions, UIOptions, UIContainerAttrs, SettingSchemaDesc, IUserOffHook } from './LSPlugin';
import * as CSS from 'csstype';
import EventEmitter from 'eventemitter3';
import { LSPluginFileStorage } from './modules/LSPlugin.Storage';
declare global {
    interface Window {
        __LSP__HOST__: boolean;
    }
}
/**
 * User plugin instance
 * @public
 */
export declare class LSPluginUser extends EventEmitter<LSPluginUserEvents> implements ILSPluginUser {
    private _baseInfo;
    private _caller;
    private _settingsSchema?;
    private _connected;
    /**
     * ui frame identities
     * @private
     */
    private _ui;
    private readonly _fileStorage;
    /**
     * handler of before unload plugin
     * @private
     */
    private _beforeunloadCallback?;
    /**
     * @param _baseInfo
     * @param _caller
     */
    constructor(_baseInfo: LSPluginBaseInfo, _caller: LSPluginCaller);
    ready(model?: any, callback?: any): Promise<void>;
    ensureConnected(): void;
    beforeunload(callback: (e: any) => Promise<void>): void;
    provideModel(model: Record<string, any>): this;
    provideTheme(theme: ThemeOptions): this;
    provideStyle(style: StyleString): this;
    provideUI(ui: UIOptions): this;
    useSettingsSchema(schema: Array<SettingSchemaDesc>): this;
    updateSettings(attrs: Record<string, any>): void;
    onSettingsChanged<T = any>(cb: (a: T, b: T) => void): IUserOffHook;
    showSettingsUI(): void;
    hideSettingsUI(): void;
    setMainUIAttrs(attrs: Partial<UIContainerAttrs>): void;
    setMainUIInlineStyle(style: CSS.Properties): void;
    hideMainUI(opts?: {
        restoreEditingCursor: boolean;
    }): void;
    showMainUI(opts?: {
        autoFocus: boolean;
    }): void;
    toggleMainUI(): void;
    get isMainUIVisible(): boolean;
    get connected(): boolean;
    get baseInfo(): LSPluginBaseInfo;
    get settings(): {
        [key: string]: any;
        disabled: boolean;
    };
    get caller(): LSPluginCaller;
    resolveResourceFullUrl(filePath: string): string;
    /**
     * @internal
     */
    _makeUserProxy(target: any, tag?: 'app' | 'editor' | 'db'): any;
    /**
     * @param args
     */
    _callWin(...args: any[]): Promise<any>;
    /**
     * The interface methods of {@link IAppProxy}
     */
    get App(): IAppProxy;
    get Editor(): IEditorProxy;
    get DB(): IDBProxy;
    get FileStorage(): LSPluginFileStorage;
}
export * from './LSPlugin';
/**
 * @internal
 */
export declare function setupPluginUserInstance(pluginBaseInfo: LSPluginBaseInfo, pluginCaller: LSPluginCaller): LSPluginUser;
